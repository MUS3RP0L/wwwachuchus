<script>
export default {
    data(){
        return{
            pass:false,
            loadingWizard: false,
            showRequirementsError: false,
            count:0,
            name:null,
            email:null,
            phone:null,
            url:null,
        }
    },
    methods: {
        onFinish() {
        document.getElementById("quota-aid-form").submit();
        },
        setLoading: function(value) {
            this.loadingWizard = value;
        },
        showRequirementsErrorChanged(val){
            this.showRequirementsError = val;
        },
         validateFirstStep() {
            this.showRequirementsError = false;
            if (!this.$refs.one.$children[0].city_end_id) {
                return false;
            }
            if (!this.$refs.one.$children[0].modality) {
                return false;
            }
            let x=this.$refs.one.$children[0].requirementList;
            var someRequirement=true;
            Object.keys(x).forEach(function(key) {
                if( !x[key].some(rq=> rq.status) ){
                    someRequirement=false;
                }
            });
            if (!someRequirement) {
                this.showRequirementsError = ! this.showRequirementsError;
                return false;
            }
            return true;
        },
         validateSecondStep() {
            if (!this.$refs.two.$children[0].applicant_type) {
                return false;
            }
            if (!this.$refs.two.$children[0].applicant_identity_card) {
                return false;
            }
            if (!this.$refs.two.$children[0].applicant_first_name) {
                return false;
            }
            if (!this.$refs.two.$children[0].applicant_kinship_id) {
                return false;
            }
            if (!this.$refs.two.$children[0].applicant_city_identity_card_id) {
                return false;
            }
            if (!this.$refs.two.$children[0].applicant_gender) {
                return false;
            }

            if (this.$refs.two.$children[0].applicant_type == 3) {
                // 3 id de Apoderado
                if (!this.$refs.two.$children[0].legal_guardian_first_name) {
                    return false;
                }
                if (!this.$refs.two.$children[0].legal_guardian_identity_card) {
                    return false;
                }
            }

            this.sendApplicant();
            return true;

        },
        sendApplicant() {
        let applicant = {
            type: this.$refs.two.$children[0].applicant_type,
            first_name: this.$refs.two.$children[0].applicant_first_name,
            second_name: this.$refs.two.$children[0].applicant_second_name,
            last_name: this.$refs.two.$children[0].applicant_last_name,
            mothers_last_name: this.$refs.two.$children[0].applicant_mothers_last_name,
            surname_husband: this.$refs.two.$children[0].applicant_surname_husband,
            identity_card: this.$refs.two.$children[0].applicant_identity_card,
            city_identity_card_id: this.$refs.two.$children[0].applicant_city_identity_card_id,
            kinship_id: this.$refs.two.$children[0].applicant_kinship_id,
            birth_date: this.$refs.two.$children[0].applicant_birth_date,
            gender: this.$refs.two.$children[0].applicant_gender,
            phone_number: this.$refs.two.$children[0].applicant_phone_number,
            cell_phone_number: this.$refs.two.$children[0].applicant_cell_phone_number
        };
        this.$store.commit("quotaAidForm/setApplicant", applicant);
        return true;
        }
    },
    computed: {
    //   checkboxErrors () {
    //     const errors = []
    //     if (!this.$v.checkbox.$dirty) return errors
    //     !this.$v.checkbox.required && errors.push('You must agree to continue!')
    //     return errors
    //   },
    //   selectErrors () {
    //     const errors = []
    //     if (!this.$v.select.$dirty) return errors
    //     !this.$v.select.required && errors.push('Item is required')
    //     return errors
    //   },
    //   nameErrors () {
    //     const errors = []
    //     if (!this.$v.name.$dirty) return errors
    //     !this.$v.name.maxLength && errors.push('Name must be at most 10 characters long')
    //     !this.$v.name.required && errors.push('Name is required.')
    //     return errors
    //   },
    //   emailErrors () {
    //     const errors = []
    //     if (!this.$v.email.$dirty) return errors
    //     !this.$v.email.email && errors.push('Must be valid e-mail')
    //     !this.$v.email.required && errors.push('E-mail is required')
    //     return errors
    //   }
    },

};
</script>
